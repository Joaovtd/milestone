{% extends "base.html" %}

{% block title %}Catálogo de Filmes{% endblock %}

{% block content %}
<section class="filters">
  <div class="filters-row">
    <div>
      <h2>Filmes</h2>
      {% if query %}
      <p>Resultados para: <strong>{{ query }}</strong></p>
      {% endif %}
    </div>

    {% if genres %}
    <form method="get" action="{{ url_for('index') }}" class="genre-form">
      {% if query %}
      <input type="hidden" name="q" value="{{ query }}" />
      {% endif %}
      <label for="genre">Filtrar por gênero:</label>
      <select name="genre" id="genre" onchange="this.form.submit()">
        <option value="">Todos</option>
        {% for genre in genres %}
        <option
          value="{{ genre }}"
          {% if genre == selected_genre %}selected{% endif %}
        >
          {{ genre }}
        </option>
        {% endfor %}
      </select>
      <noscript><button type="submit">Filtrar</button></noscript>
    </form>
    {% endif %}
  </div>
</section>

{% if movies %}
<section class="movie-grid">
  {% for movie in movies %}
  <article class="movie-card">
    <a href="{{ url_for('movie_detail', imdb_id=movie.imdbID) }}">
      <div class="poster-wrapper">
        {% if movie.Poster and movie.Poster != 'N/A' %}
        <img src="{{ movie.Poster }}" alt="Poster de {{ movie.Title }}" />
        {% else %}
        <div class="poster-placeholder">Sem imagem</div>
        {% endif %}
      </div>
      <div class="movie-info">
        <h3>{{ movie.Title }}</h3>
        <p class="year">{{ movie.Year or "Ano desconhecido" }}</p>
        {% if movie.imdbRating and movie.imdbRating != 'N/A' %}
        <p class="rating">⭐ {{ movie.imdbRating }}/10</p>
        {% endif %}
        {% if movie.Genre %}
        <p class="genres">{{ movie.Genre }}</p>
        {% endif %}
      </div>
    </a>
  </article>
  {% endfor %}
</section>
{% else %}
<p>Nenhum filme encontrado. Tente outro termo de busca.</p>
{% endif %}
{% endblock %}


